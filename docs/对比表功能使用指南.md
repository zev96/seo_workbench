# 对比表功能使用指南

## 功能概述

对比表功能允许你在生成Word文档时，自动识别文章中提及的品牌关键词，从数据库调取对应参数，后台绘制生成高清对比表格图片，并将其插入到Word文档的指定位置。

## 快速开始

### 1. 打开数据库管理界面

在主窗口左侧导航栏，点击 **"数据库"** 按钮，进入对比表管理界面。

### 2. 创建类目

1. 在左侧类目栏底部，点击 **"新建类目"** 按钮
2. 输入类目名称（如："吸尘器"、"洗地机"等）
3. 点击确定

### 3. 添加品牌和参数

#### 方法一：手动添加

1. 选择一个类目
2. 在右侧表格区域右键，选择：
   - **"插入列"**：添加品牌（如：希喂、美的、小米）
   - **"插入行"**：添加参数（如：价格、功率、重量）
3. 双击单元格编辑内容

#### 方法二：Excel导入

1. 准备Excel文件，格式如下：

```
参数/品牌  | 希喂   | 美的   | 小米
价格      | 999元  | 1299元 | 1199元
功率      | 2000W  | 1800W  | 2200W
重量      | 3.5kg  | 4.2kg  | 3.8kg
```

2. 选择类目后，点击左侧的 **"导入 Excel"** 按钮
3. 选择Excel文件，自动导入

### 4. 配置插入策略

点击顶部的 **"插入策略配置"** 按钮：

#### 品牌匹配设置

- **我方品牌名称**：输入你的品牌名（如"希喂"），该品牌将永远出现在表格第一列
- **保底竞品数量**：如果文章未提及任何竞品，随机选取N个竞品进行对比

#### 插入位置设置

选择插入模式：

- **按列插入**：在第N列对应的段落后插入图片
- **智能锚点**：检测到特定文本（如"参数对比"）时，在下一行插入图片

### 5. 配置表格样式

点击顶部的 **"表格样式设置"** 按钮：

- **预设风格**：商务蓝、清新绿、强对比黄
- **表头背景色**：自定义表头颜色
- **我方品牌背景色**：高亮显示我方品牌列
- **边框粗细**：设置表格边框宽度
- **图片宽度**：设置插入Word时的图片宽度（单位：厘米）
- **分辨率(DPI)**：建议300以确保清晰度
- **字体和字号**：设置表格文字样式

## 生成流程

1. 在主界面完成内容编辑
2. 点击 **"开始生成"**
3. 系统会自动：
   - 扫描文章内容，识别品牌关键词
   - 从数据库调取对应参数数据
   - 使用Matplotlib绘制高清表格图片
   - 根据插入策略，将图片插入到指定位置

## 工作原理

### 品牌识别机制

系统会扫描生成的文档全文，查找数据库中存储的品牌名称：

- **精确匹配**：只有完全匹配的品牌才会被识别
- **我方品牌优先**：你配置的"我方品牌"永远显示在表格第一列
- **动态竞品**：文章中提及的竞品会自动包含在表格中
- **保底机制**：如果竞品不足，随机补充到设定数量

### 插入位置逻辑

#### 按列插入模式

例如设置"在第2列后插入"：

```
第1列：H1标题
第2列：产品介绍  ← 在这一列对应段落后插入对比表
第3列：使用体验
```

#### 智能锚点模式

例如设置锚点文本为"参数对比"：

```
...产品功能强大，下面是参数对比：
                            ↓
                    [对比表图片插入此处]
                            ↓
产品的优势在于...
```

### 图片生成技术

- 使用 **Matplotlib** 绘制表格
- 支持 **300 DPI** 高分辨率输出
- 自动处理 **中文字体** 显示
- 可自定义 **配色方案**

## 高级技巧

### 1. 标记我方品牌

在表格编辑时，确保我方品牌列被正确识别：

- 第一次添加品牌时，将我方品牌命名为配置中设置的名称
- 系统会自动高亮显示我方品牌列

### 2. 参数排序

参数的显示顺序与数据库中的顺序一致：

- 通过删除并重新添加可以调整顺序
- 或者直接在Excel中调整好顺序后导入

### 3. 多类目管理

如果你有多个产品类别：

- 为每个类别创建独立的类目
- 系统会自动匹配文章内容与类目
- 当前版本使用第一个类目（后续可扩展智能匹配）

### 4. 样式调优

建议配置：

- **DPI**: 300（确保清晰度）
- **图片宽度**: 15cm（适合A4页面）
- **边框粗细**: 1.5（视觉效果好）
- **字号**: 10（可读性强）

## 常见问题

### Q: 为什么对比表没有插入？

A: 检查以下几点：
1. 是否配置了插入策略？
2. 是否创建了类目和数据？
3. 按列插入：列索引是否正确？
4. 智能锚点：文章中是否包含锚点文本？

### Q: 生成的图片模糊怎么办？

A: 
- 将DPI设置为300或更高
- 确保图片宽度设置合理（推荐15cm）

### Q: 中文显示乱码？

A: 
- 系统会自动尝试使用系统中文字体
- 确保系统中安装了"Microsoft YaHei"或"SimHei"字体

### Q: 如何批量修改数据？

A: 
- 使用Excel编辑，然后重新导入
- 导入前建议删除旧数据

### Q: 能否识别不同产品类别？

A: 
- 当前版本使用第一个类目
- 未来版本会支持根据文章内容智能匹配类目

## 更新日志

### v1.0.0 (2025-12-03)

- ✅ 数据库管理界面
- ✅ Excel导入导出
- ✅ 三大配置对话框
- ✅ Matplotlib图片生成
- ✅ Word文档自动插入
- ✅ 品牌智能识别
- ✅ 多种插入策略

---

如有问题，请查看日志文件或联系技术支持。

